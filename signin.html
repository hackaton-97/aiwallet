<!DOCTYPE html>

<html class="dark" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>AI Wallet | Sign In</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#a7c69f",
              "background-light": "#f7f7f6",
              "background-dark": "#171c16",
            },
            fontFamily: {
              "display": ["Space Grotesk"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
            boxShadow: {
              'glow': '0 0 15px 2px rgba(167, 198, 159, 0.4)',
              'glow-lg': '0 0 25px 5px rgba(167, 198, 159, 0.5)',
            }
          },
        }
      }
    </script>
    <style>
      /* Light mode styles */
      html:not(.dark) { background-color: #ffffff !important;
        color: #1a1a1a;
      }
      html:not(.dark) body { background-color: #ffffff !important;
        color: #1a1a1a;
      }
      html:not(.dark) header {
        background-color: #ffffff !important;
        border-color: #e0e0e0 !important;
        color: #1a1a1a;
      }
      html:not(.dark) footer {
        background-color: #f5f5f5 !important;
        color: #1a1a1a;
        border-color: #e0e0e0 !important;
      }
      html:not(.dark) [class*="text-white"],
      html:not(.dark) [class*="text-primary"] {
        color: #1a1a1a !important;
      }
      html:not(.dark) [class*="text-white/"],
      html:not(.dark) [class*="text-primary/"] {
        color: rgba(26, 26, 26, 0.8) !important;
      }
      html:not(.dark) [class*="bg-[#"],
      html:not(.dark) [class*="bg-custom"] {
        background-color: #f5f5f5 !important;
      }
      html:not(.dark) [class*="border-"] {
        border-color: #e0e0e0 !important;
      }
    
        html:not(.dark) [class*="text-[#A7C69F]"], html:not(.dark) [class*="text-custom-accent"] { color: #5a7a4f !important; }
        html:not(.dark) svg { color: #1a1a1a !important; }
        html:not(.dark) * { color: #1a1a1a !important; }
        html:not(.dark) div { background-color: #ffffff !important; }
        html:not(.dark) button { background-color: #f5f5f5 !important; color: #1a1a1a !important; }
        html:not(.dark) input { background-color: #f5f5f5 !important; color: #1a1a1a !important; border-color: #e0e0e0 !important; }
        html:not(.dark) h1, html:not(.dark) h2, html:not(.dark) h3 { color: #1a1a1a !important; }
        html:not(.dark) #profileModal > div {
          background-color: #ffffff !important;
          border-color: #5a7a4f !important;
        }
        html:not(.dark) #profileModal button {
          color: #1a1a1a !important;
        }
        html:not(.dark) #profileModal button:last-child {
          color: #ef4444 !important;
        }
        html:not(.dark) #profileModal button:hover {
          background-color: #f0f0f0 !important;
        }
        html:not(.dark) #profileAvatar {
          border-color: #5a7a4f !important;
        }
    </style>
<style>.circuit-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: linear-gradient(rgba(51, 51, 51, 0.95), rgba(51, 51, 51, 0.95)), url(https://lh3.googleusercontent.com/aida-public/AB6AXuCpFh7OSUzEj0XKLJfBIIV04v-GovLLGjGnzDoQbT0ps0Df9oU8HHpWzi4FU3EgN14NBNziFl4HZcvrKRIUfrB1wovmysIFaTBEbmc8R-7C8ndna4mgfw2eBXQcnnGJmYoAv3r98aJO0Nn8M4fCw14NBF3PWea5A4IR7yc2kkzNdVtZh8_iOgzDSH1Tvn6i9pRDZszXGg4L7kGCz_NRI0F8qoAkp4S5JrV2-3XpTR15xeC-kj1YhQ82SbMUKY4K9_ngc4YGUunxrFQL)
    }
        html:not(.dark) [class*="text-[#A7C69F]"], html:not(.dark) [class*="text-custom-accent"] { color: #5a7a4f !important; }
        html:not(.dark) svg { color: #1a1a1a !important; }
    </style>
<script src="api-wrapper.js"></script>
<script src="script.js" defer></script>
</head>
<body class="font-display">
<div class="relative flex h-auto min-h-screen w-full flex-col bg-[#333333] group/design-root overflow-hidden">
<div class="circuit-bg" data-alt="abstract technological pattern"></div>
<header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-primary/20 px-10 py-4 backdrop-blur-sm relative z-10">
<a href="index.html" class="flex items-center gap-4 text-primary cursor-pointer hover:opacity-80 transition-opacity">
<div class="size-5">
<svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
<path clip-rule="evenodd" d="M24 4H6V17.3333V30.6667H24V44H42V30.6667V17.3333H24V4Z" fill="currentColor" fill-rule="evenodd"></path>
</svg>
</div>
<h2 class="text-white text-xl font-bold leading-tight tracking-[-0.015em]">AIWallet</h2>
</a>
<div class="flex flex-1 justify-end gap-8">
  <div class="flex items-center gap-9">
    <a id="dashboardLink" class="hidden text-white/80 text-sm font-medium leading-normal transition-colors hover:text-primary hover:drop-shadow-[0_0_8px_primary]" href="profile.html">Dashboard</a>
    <a class="text-white/80 text-sm font-medium leading-normal transition-colors hover:text-primary hover:drop-shadow-[0_0_8px_primary]" href="overview.html">Overview</a>
    <a class="text-white/80 text-sm font-medium leading-normal transition-colors hover:text-primary hover:drop-shadow-[0_0_8px_primary]" href="features.html">Features</a>
    <a class="text-white/80 text-sm font-medium leading-normal transition-colors hover:text-primary hover:drop-shadow-[0_0_8px_primary]" href="pricing.html">Pricing</a>
    <a class="text-white/80 text-sm font-medium leading-normal transition-colors hover:text-primary hover:drop-shadow-[0_0_8px_primary]" href="resources.html">Resources</a>
  </div>
<div class="flex gap-2">
<button id="themeToggle" class="flex min-w-[40px] w-10 h-10 cursor-pointer items-center justify-center overflow-hidden rounded-lg bg-transparent border border-primary/50 text-primary font-bold transition-all hover:bg-primary/10 hover:border-primary hover:shadow-[0_0_8px_primary_inset]" title="Toggle theme">
<span id="themeIcon">üåô</span>
</button>
<div id="authButtons" class="flex gap-2">
<a href="signup.html" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-[#333333] text-sm font-bold leading-normal tracking-[0.015em] transition-all hover:bg-white hover:shadow-[0_0_15px_primary] border border-primary">
<span class="truncate">Get Started</span>
</a>
</div>
<div id="profileAvatar" class="hidden flex items-center justify-center w-10 h-10 rounded-lg bg-primary text-[#333333] font-bold text-lg cursor-pointer hover:shadow-[0_0_15px_primary] transition-all border border-primary" title="Profile" onclick="toggleProfileMenu()">
<span id="avatarInitial">U</span>
</div>
</div>
</div>
</header>

<!-- Profile Menu Modal -->
<div id="profileModal" class="hidden fixed inset-0 z-50 flex items-start justify-end pt-20 pr-10">
<div class="bg-black/90 border border-primary/30 rounded-lg shadow-lg min-w-[200px] backdrop-blur-sm">
<div class="p-4 space-y-3">
<div class="text-white text-sm px-4 py-2 border-b border-primary/20">
<p class="font-semibold"><span id="profileUsername">User</span></p>
<p class="text-xs text-gray-400"><span id="profileEmail">email@example.com</span></p>
</div>
<button onclick="handleLogout()" class="w-full text-left px-4 py-2 text-white hover:bg-primary/10 transition-colors rounded flex items-center gap-2"><span class="material-symbols-outlined" style="font-size: 20px; display: inline-flex;">logout</span> Logout</button>
<button onclick="handleDeleteAccount()" class="w-full text-left px-4 py-2 text-red-500 hover:bg-red-500/10 transition-colors rounded flex items-center gap-2"><span class="material-symbols-outlined" style="font-size: 20px; display: inline-flex;">delete</span> Delete Account</button>
</div>
</div>
</div>
<div class="layout-container flex h-full grow flex-col justify-center items-center relative z-10 p-4">
<a href="index.html" class="absolute left-4 top-4 text-primary hover:text-white transition-colors">
<span class="material-symbols-outlined text-4xl">
                        arrow_back
                    </span>
</a>
<div class="layout-content-container flex flex-col max-w-md w-full items-center p-8 rounded-xl bg-black/30 backdrop-blur-sm border border-primary/20">
<a href="index.html" class="flex flex-col items-center justify-center pb-6 cursor-pointer hover:opacity-80 transition-opacity">
<span class="material-symbols-outlined text-primary text-5xl">
                        shield
                    </span>
<h1 class="text-white tracking-light text-[32px] font-bold leading-tight text-center pt-2 font-display">AIWallet</h1>
</a>
<h1 class="text-white tracking-light text-2xl font-bold leading-tight px-4 text-center pb-8 font-display">Sign In</h1>
<div class="w-full flex flex-col gap-6">
<div class="flex w-full flex-wrap items-end">
<label class="flex flex-col min-w-40 flex-1">
<p class="text-white text-base font-medium leading-normal pb-2 font-display">Email / Username</p>
<input id="signinEmailOrUsername" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-white focus:outline-0 focus:ring-2 focus:ring-primary border border-[#485445] bg-[#242a22] h-14 placeholder:text-[#a9b6a5] p-[15px] text-base font-normal leading-normal font-display shadow-glow focus:shadow-glow-lg transition-shadow duration-300" placeholder="Enter your email or username" value=""/>
</label>
</div>
<div class="flex w-full flex-wrap items-end">
<label class="flex flex-col min-w-40 flex-1">
<p class="text-white text-base font-medium leading-normal pb-2 font-display">Password</p>
<div class="flex w-full flex-1 items-stretch rounded-lg shadow-glow focus-within:shadow-glow-lg focus-within:ring-2 focus-within:ring-primary transition-shadow duration-300">
<input id="signinPassword" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-l-lg text-white focus:outline-0 focus:ring-0 border border-r-0 border-[#485445] bg-[#242a22] h-14 placeholder:text-[#a9b6a5] p-[15px] text-base font-normal leading-normal font-display" placeholder="Enter your password" type="password" value=""/>
<div class="text-[#a9b6a5] flex border border-l-0 border-[#485445] bg-[#242a22] items-center justify-center pr-[15px] rounded-r-lg cursor-pointer" id="signinPasswordToggle">
<span class="material-symbols-outlined" id="signinPasswordIcon">
                                        visibility_off
                                    </span>
</div>
</div>
</label>
</div>
</div>
<div class="w-full text-right mt-2">
<a href="https://help.steampowered.com/en/wizard/HelpWithLoginInfo?accountsearch=1" target="_blank" rel="noopener noreferrer" class="text-[#a9b6a5] text-sm font-normal leading-normal pt-1 px-0 underline hover:text-primary cursor-pointer font-display">Forgot Password?</a>
</div>
<div id="signinMessage" class="w-full mb-4 text-center"></div>
<div class="flex w-full px-0 py-6 justify-center">
<button id="signinBtn" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 px-5 flex-1 bg-primary text-[#333333] text-base font-bold leading-normal tracking-[0.015em] font-display shadow-glow-lg hover:shadow-glow transition-shadow duration-300">
<span class="truncate">LOGIN</span>
</button>
</div>
</div>
</div>
</div>
</body>
<script>
// Add Enter key handler for form inputs
function addEnterKeyHandlers() {
  const signinBtn = document.getElementById('signinBtn');
  const inputs = ['signinEmailOrUsername', 'signinPassword'];
  
  inputs.forEach(inputId => {
    const input = document.getElementById(inputId);
    if (input) {
      input.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && !e.shiftKey && !e.ctrlKey && !e.altKey) {
          e.preventDefault();
          signinBtn.click();
        }
      });
    }
  });
}

// Initialize on page load
window.addEventListener('load', function() {
  checkUserStatus();
  addEnterKeyHandlers();
});

// Check if user is already logged in
function checkUserStatus() {
  const userId = localStorage.getItem('userId');
  const username = localStorage.getItem('username');
  const authButtons = document.getElementById('authButtons');
  const profileAvatar = document.getElementById('profileAvatar');
  const avatarInitial = document.getElementById('avatarInitial');
  
  if (userId && username) {
    // User is logged in
    authButtons.classList.add('hidden');
    profileAvatar.classList.remove('hidden');
    avatarInitial.textContent = username.charAt(0).toUpperCase();
  } else {
    // User is not logged in
    authButtons.classList.remove('hidden');
    profileAvatar.classList.add('hidden');
  }
}

function toggleProfileMenu() {
  const profileModal = document.getElementById('profileModal');
  const username = localStorage.getItem('username');
  const email = localStorage.getItem('email');
  
  // Update profile info
  document.getElementById('profileUsername').textContent = username || 'User';
  document.getElementById('profileEmail').textContent = email || 'email@example.com';
  
  // Toggle modal
  if (profileModal.classList.contains('hidden')) {
    profileModal.classList.remove('hidden');
  } else {
    profileModal.classList.add('hidden');
  }
}

function handleLogout() {
  if (confirm('Are you sure you want to logout?')) {
    localStorage.removeItem('userId');
    localStorage.removeItem('username');
    localStorage.removeItem('email');
    document.getElementById('profileModal').classList.add('hidden');
    setTimeout(function() {
      checkUserStatus();
      window.location.href = 'signin.html';
    }, 100);
  }
}

function handleDeleteAccount() {
  if (confirm('Are you sure you want to delete your account? This action cannot be undone!')) {
    const userId = localStorage.getItem('userId');
    
    // Remove user from database
    let users = JSON.parse(localStorage.getItem('aiwallet_users') || '[]');
    users = users.filter(u => u.id !== userId);
    localStorage.setItem('aiwallet_users', JSON.stringify(users));
    
    // Clear session
    localStorage.removeItem('userId');
    localStorage.removeItem('username');
    localStorage.removeItem('email');
    
    alert('Account deleted successfully');
    document.getElementById('profileModal').classList.add('hidden');
    setTimeout(function() {
      checkUserStatus();
      window.location.href = 'signin.html';
    }, 100);
  }
}

// Close modal when clicking outside
document.addEventListener('click', function(e) {
  const profileModal = document.getElementById('profileModal');
  const profileAvatar = document.getElementById('profileAvatar');
  
  if (!profileModal.contains(e.target) && !profileAvatar.contains(e.target)) {
    profileModal.classList.add('hidden');
  }
});

// Update avatar from localStorage on load
window.addEventListener('load', function() {
  const userAvatar = localStorage.getItem('userAvatar');
  const profileAvatar = document.getElementById('profileAvatar');
  if (userAvatar && profileAvatar && profileAvatar.querySelector('span')) {
    profileAvatar.innerHTML = '';
    const img = document.createElement('img');
    img.src = userAvatar;
    img.className = 'w-full h-full rounded-lg object-cover';
    img.style.cursor = 'pointer';
    img.onclick = () => toggleProfileMenu();
    profileAvatar.appendChild(img);
  }
});

// Password visibility toggle for signin
document.getElementById('signinPasswordToggle')?.addEventListener('click', function() {
  const passwordInput = document.getElementById('signinPassword');
  const icon = document.getElementById('signinPasswordIcon');
  
  if (passwordInput.type === 'password') {
    passwordInput.type = 'text';
    icon.textContent = 'visibility';
  } else {
    passwordInput.type = 'password';
    icon.textContent = 'visibility_off';
  }
});

// Form submission for signin
document.getElementById('signinBtn').addEventListener('click', async function(e) {
  e.preventDefault();
  const emailOrUsername = document.getElementById('signinEmailOrUsername').value;
  const password = document.getElementById('signinPassword').value;
  const messageDiv = document.getElementById('signinMessage');
  messageDiv.innerHTML = '';
  
  if (!emailOrUsername || !password) {
    messageDiv.innerHTML = '<p class="text-red-500 text-sm">All fields are required</p>';
    return;
  }
  
  // –ï—Å–ª–∏ –≤–≤–µ–¥—ë–Ω email ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å
  if(emailOrUsername.includes('@')){
    if(!/^([^\s@]+)@([^\s@]+)\.[^\s@]+$/.test(emailOrUsername)){
      messageDiv.innerHTML = '<p class="text-red-500 text-sm">Enter a valid email address</p>';
      return;
    }
  }
  
  // Disable button during request
  const signinBtn = document.getElementById('signinBtn');
  signinBtn.disabled = true;
  signinBtn.innerHTML = '<span class="truncate">LOGGING IN...</span>';
  
  try {
    // Use API wrapper
    const result = await window.apiWrapper.login(emailOrUsername, password);
    
    if (result.success) {
      messageDiv.innerHTML = '<p class="text-green-500 text-sm">Login successful! Redirecting...</p>';
      localStorage.setItem('userId', result.userId);
      localStorage.setItem('username', result.username);
      localStorage.setItem('email', result.email);
      
      // Load subscription from result
      if (result.userPlan) {
        localStorage.setItem('userPlan', result.userPlan);
      } else {
        localStorage.removeItem('userPlan');
      }
      if (result.planPurchaseDate) {
        localStorage.setItem('planPurchaseDate', result.planPurchaseDate);
      } else {
        localStorage.removeItem('planPurchaseDate');
      }
      
      // Also try to load from server if available (for sync)
      try {
        const userData = await window.apiWrapper.getUser(result.userId);
        if (userData.success && userData.user) {
          if (userData.user.userPlan) {
            localStorage.setItem('userPlan', userData.user.userPlan);
          }
          if (userData.user.planPurchaseDate) {
            localStorage.setItem('planPurchaseDate', userData.user.planPurchaseDate);
          }
        }
      } catch (err) {
        console.warn('Failed to sync user data from server:', err);
      }
      
      setTimeout(() => {
        checkUserStatus();
        window.location.href = 'index.html';
      }, 1500);
    } else {
      messageDiv.innerHTML = `<p class="text-red-500 text-sm">${result.message || 'Login failed'}</p>`;
      signinBtn.disabled = false;
      signinBtn.innerHTML = '<span class="truncate">LOGIN</span>';
    }
  } catch (error) {
    console.error('Login error:', error);
    messageDiv.innerHTML = '<p class="text-red-500 text-sm">An error occurred. Please try again.</p>';
    signinBtn.disabled = false;
    signinBtn.innerHTML = '<span class="truncate">LOGIN</span>';
  }
});
</script>
</html>








